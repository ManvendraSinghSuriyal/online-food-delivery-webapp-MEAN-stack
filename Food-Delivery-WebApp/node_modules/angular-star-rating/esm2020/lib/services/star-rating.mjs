/* eslint-disable @angular-eslint/component-class-suffix */
import { Component, Input } from '@angular/core';
import { StarRatingUtils } from './star-rating.utils';
import * as i0 from "@angular/core";
import * as i1 from "./star-rating-config.service";
export class StarRating {
    constructor(config) {
        this.config = config;
        //set default ctrl props
        this.classEmpty = this.config.classEmpty;
        this.classHalf = this.config.classHalf;
        this.classFilled = this.config.classFilled;
        this.pathEmpty = this.config.svgPathEmpty;
        this.pathHalf = this.config.svgPathHalf;
        this.pathFilled = this.config.svgPathFilled;
        //set default Component Inputs
        if ('getColor' in this.config &&
            typeof this.config.getColor === 'function') {
            this.getColor = this.config.getColor;
        }
        if ('getHalfStarVisible' in this.config &&
            typeof this.config.getHalfStarVisible === 'function') {
            this.getHalfStarVisible = this.config.getHalfStarVisible;
        }
        this.numOfStars = this.config.numOfStars;
        this.rating = 0;
        this.step = 1;
    }
    get showHalfStars() {
        return this._showHalfStars;
    }
    set showHalfStars(value) {
        this._showHalfStars = !!value;
        //update halfStarVisible
        this.setHalfStarVisible();
    }
    get id() {
        return this._id;
    }
    set id(value) {
        this._id = value || '';
    }
    get focus() {
        return this._focus;
    }
    set focus(value) {
        this._focus = !!value;
    }
    get labelText() {
        return this._labelText;
    }
    set labelText(value) {
        this._labelText = value;
    }
    get labelPosition() {
        return this._labelPosition;
    }
    set labelPosition(value) {
        this._labelPosition = value || this.config.labelPosition;
    }
    get labelVisible() {
        return this._labelVisible;
    }
    set labelVisible(value) {
        this._labelVisible = !!value;
    }
    get hoverEnabled() {
        return this._hoverEnabled;
    }
    set hoverEnabled(value) {
        this._hoverEnabled = value !== undefined ? !!value : false;
    }
    get staticColor() {
        return this._staticColor || this.config.staticColor || undefined;
    }
    set staticColor(value) {
        this._staticColor = value;
        //update color.
        this.setColor();
    }
    get direction() {
        return this._direction;
    }
    set direction(value) {
        this._direction = value || undefined;
    }
    get numOfStars() {
        return this._numOfStars;
    }
    set numOfStars(value) {
        this._numOfStars = value > 0 ? value : this.config.numOfStars;
        //update stars array
        this.stars = StarRatingUtils.getStarsArray(this.numOfStars);
        //update color
        this.setColor();
    }
    get hoverRating() {
        return this._hoverRating;
    }
    set hoverRating(value) {
        this._hoverRating = value > 0 ? value : 0;
    }
    get speed() {
        return this._speed;
    }
    set speed(value) {
        this._speed = value || this.config.speed;
    }
    get size() {
        return this._size || this.config.size;
    }
    set size(value) {
        this._size = value;
    }
    get starType() {
        return this._starType || this.config.starType;
    }
    set starType(value) {
        this._starType = value;
    }
    get space() {
        return this._space;
    }
    set space(value) {
        this._space = value;
    }
    get readOnly() {
        return this._readOnly;
    }
    set readOnly(value) {
        this._readOnly = !!value;
    }
    get disabled() {
        return this._disabled;
    }
    set disabled(value) {
        this._disabled = !!value;
    }
    get step() {
        return this._step;
    }
    set step(value) {
        this._step = value > 0 ? value : 1;
    }
    get rating() {
        return this._rating;
    }
    set rating(value) {
        this.setRating(value);
    }
    /**
     * setRating
     * I use a setter function instead of a set method to enable overrides for this function.
     * @param value
     */
    setRating(value) {
        //validate and apply newRating
        let newRating = 0;
        if (value >= 0 && value <= this.numOfStars) {
            newRating = value;
        }
        //limit max value to max number of stars
        if (value > this.numOfStars) {
            newRating = this.numOfStars;
        }
        this._rating = newRating;
        //update ratingAsInteger. rating parsed to int for the value-[n] modifier
        this.ratingAsInteger = parseInt(this._rating?.toString(), 10);
        //update halfStarsVisible
        this.setHalfStarVisible();
        //update calculated Color
        this.setColor();
    }
    svgVisible() {
        return this.starType === 'svg';
    }
    interactionPossible() {
        return !this.readOnly && !this.disabled;
    }
    setColor(useHoverValue = false) {
        //check if custom function is given
        const ratingValue = useHoverValue ? this.hoverRating : this.rating;
        if (typeof this.getColor === 'function') {
            this.color = this.getColor(ratingValue, this.numOfStars, this.staticColor);
        }
        else {
            this.color = StarRatingUtils.getColor(ratingValue, this.numOfStars, this.staticColor);
        }
    }
    setHalfStarVisible() {
        //update halfStarVisible
        if (this.showHalfStars) {
            //check if custom function is given
            if (typeof this.getHalfStarVisible === 'function') {
                this.halfStarVisible = this.getHalfStarVisible(this.rating);
            }
            else {
                this.halfStarVisible = StarRatingUtils.getHalfStarVisible(this.rating);
            }
        }
        else {
            this.halfStarVisible = false;
        }
    }
    getComponentClassNames() {
        const classNames = [];
        classNames.push(this.rating ? 'value-' + this.ratingAsInteger : 'value-0');
        classNames.push(this.halfStarVisible ? 'half' : '');
        classNames.push(this.hoverEnabled ? 'hover' : '');
        const hoverRating = this.hoverRating
            ? 'hover-' + this.hoverRating
            : 'hover-0';
        classNames.push(this.hoverEnabled ? hoverRating : '');
        classNames.push(this.space ? 'space-' + this.space : '');
        classNames.push(this.labelPosition ? 'label-' + this.labelPosition : '');
        classNames.push(this.color ? 'color-' + this.color : '');
        classNames.push(this.starType ? 'star-' + this.starType : '');
        classNames.push(this.speed);
        classNames.push(this.size);
        classNames.push(this.readOnly ? 'read-only' : '');
        classNames.push(this.disabled ? 'disabled' : '');
        classNames.push(this.direction ? 'direction-' + this.direction : '');
        return classNames.join(' ');
    }
    increment() {
        //increment to next higher step
        const absDiff = Math.abs(this.rating % this.step);
        this.rating = this.rating + (absDiff > 0 ? this.step - absDiff : this.step);
    }
    decrement() {
        //decrement to next lower step
        const absDiff = Math.abs(this.rating % this.step);
        this.rating = this.rating - (absDiff > 0 ? absDiff : this.step);
    }
    reset() {
        this.rating = 0;
    }
}
StarRating.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.0.0", ngImport: i0, type: StarRating, deps: [{ token: i1.StarRatingConfigService }], target: i0.ɵɵFactoryTarget.Component });
StarRating.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.0.0", type: StarRating, selector: "placeholder-star-rating", inputs: { showHalfStars: "showHalfStars", id: "id", focus: "focus", labelText: "labelText", labelPosition: "labelPosition", labelVisible: "labelVisible", hoverEnabled: "hoverEnabled", staticColor: "staticColor", direction: "direction", numOfStars: "numOfStars", hoverRating: "hoverRating", speed: "speed", size: "size", starType: "starType", space: "space", readOnly: "readOnly", disabled: "disabled", step: "step", rating: "rating" }, ngImport: i0, template: ``, isInline: true });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.0.0", ngImport: i0, type: StarRating, decorators: [{
            type: Component,
            args: [{
                    // Metadata needed for Angular.
                    template: ``,
                    selector: 'placeholder-star-rating'
                }]
        }], ctorParameters: function () { return [{ type: i1.StarRatingConfigService }]; }, propDecorators: { showHalfStars: [{
                type: Input
            }], id: [{
                type: Input
            }], focus: [{
                type: Input
            }], labelText: [{
                type: Input
            }], labelPosition: [{
                type: Input
            }], labelVisible: [{
                type: Input
            }], hoverEnabled: [{
                type: Input
            }], staticColor: [{
                type: Input
            }], direction: [{
                type: Input
            }], numOfStars: [{
                type: Input
            }], hoverRating: [{
                type: Input
            }], speed: [{
                type: Input
            }], size: [{
                type: Input
            }], starType: [{
                type: Input
            }], space: [{
                type: Input
            }], readOnly: [{
                type: Input
            }], disabled: [{
                type: Input
            }], step: [{
                type: Input
            }], rating: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3Rhci1yYXRpbmcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL2FuZ3VsYXItc3Rhci1yYXRpbmcvc3JjL2xpYi9zZXJ2aWNlcy9zdGFyLXJhdGluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwyREFBMkQ7QUFDM0QsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFhakQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDOzs7QUFPdEQsTUFBTSxPQUFPLFVBQVU7SUFpVnJCLFlBQVksTUFBK0I7UUFDekMsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFFckIsd0JBQXdCO1FBQ3hCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFXLENBQUM7UUFDMUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVUsQ0FBQztRQUN4QyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBWSxDQUFDO1FBQzVDLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFhLENBQUM7UUFDM0MsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVksQ0FBQztRQUN6QyxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYyxDQUFDO1FBRTdDLDhCQUE4QjtRQUM5QixJQUNFLFVBQVUsSUFBSSxJQUFJLENBQUMsTUFBTTtZQUN6QixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxLQUFLLFVBQVUsRUFDMUM7WUFDQSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDO1NBQ3RDO1FBRUQsSUFDRSxvQkFBb0IsSUFBSSxJQUFJLENBQUMsTUFBTTtZQUNuQyxP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QyxDQUFDO1FBQ3pELFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3pFLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3pELFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzlELFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzVCLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNCLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNsRCxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDakQsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFckUsT0FBTyxVQUFVLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCxTQUFTO1FBQ1AsK0JBQStCO1FBQy9CLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEQsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM5RSxDQUFDO0lBRUQsU0FBUztRQUNQLDhCQUE4QjtRQUM5QixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2xELElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2xFLENBQUM7SUFFRCxLQUFLO1FBQ0gsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7SUFDbEIsQ0FBQzs7dUdBL2JVLFVBQVU7MkZBQVYsVUFBVSxtZkFIWCxFQUFFOzJGQUdELFVBQVU7a0JBTHRCLFNBQVM7bUJBQUM7b0JBQ1QsK0JBQStCO29CQUMvQixRQUFRLEVBQUUsRUFBRTtvQkFDWixRQUFRLEVBQUUseUJBQXlCO2lCQUNwQzs4R0EyQmMsYUFBYTtzQkFBekIsS0FBSztnQkFtQ08sRUFBRTtzQkFBZCxLQUFLO2dCQWNPLEtBQUs7c0JBQWpCLEtBQUs7Z0JBY08sU0FBUztzQkFBckIsS0FBSztnQkFjTyxhQUFhO3NCQUF6QixLQUFLO2dCQWNPLFlBQVk7c0JBQXhCLEtBQUs7Z0JBY08sWUFBWTtzQkFBeEIsS0FBSztnQkFjTyxXQUFXO3NCQUF2QixLQUFLO2dCQWlCTyxTQUFTO3NCQUFyQixLQUFLO2dCQWNPLFVBQVU7c0JBQXRCLEtBQUs7Z0JBb0JPLFdBQVc7c0JBQXZCLEtBQUs7Z0JBY08sS0FBSztzQkFBakIsS0FBSztnQkFjTyxJQUFJO3NCQUFoQixLQUFLO2dCQWNPLFFBQVE7c0JBQXBCLEtBQUs7Z0JBY08sS0FBSztzQkFBakIsS0FBSztnQkFjTyxRQUFRO3NCQUFwQixLQUFLO2dCQWNPLFFBQVE7c0JBQXBCLEtBQUs7Z0JBV08sSUFBSTtzQkFBaEIsS0FBSztnQkFjTyxNQUFNO3NCQUFsQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgQGFuZ3VsYXItZXNsaW50L2NvbXBvbmVudC1jbGFzcy1zdWZmaXggKi9cbmltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHtcbiAgU3RhclJhdGluZ0NvbmZpZyxcbiAgc3RhclJhdGluZ0NvbG9yLFxuICBzdGFyUmF0aW5nRGlyZWN0aW9uLFxuICBzdGFyUmF0aW5nTGFiZWxQb3NpdGlvbixcbiAgc3RhclJhdGluZ1NpemVzLFxuICBzdGFyUmF0aW5nU3BlZWQsXG4gIHN0YXJSYXRpbmdTdGFyU3BhY2UsXG4gIHN0YXJSYXRpbmdTdGFyVHlwZXMsXG59IGZyb20gJy4uL2ludGVyZmFjZXMvc3Rhci1yYXRpbmctY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBTdGFyUmF0aW5nQ29uZmlnU2VydmljZSB9IGZyb20gJy4vc3Rhci1yYXRpbmctY29uZmlnLnNlcnZpY2UnO1xuaW1wb3J0IHsgU3RhclJhdGluZ1V0aWxzIH0gZnJvbSAnLi9zdGFyLXJhdGluZy51dGlscyc7XG5cbkBDb21wb25lbnQoe1xuICAvLyBNZXRhZGF0YSBuZWVkZWQgZm9yIEFuZ3VsYXIuXG4gIHRlbXBsYXRlOiBgYCxcbiAgc2VsZWN0b3I6ICdwbGFjZWhvbGRlci1zdGFyLXJhdGluZydcbn0pXG5leHBvcnQgY2xhc3MgU3RhclJhdGluZyB7XG4gIHByb3RlY3RlZCBjb25maWc6IFN0YXJSYXRpbmdDb25maWc7XG5cbiAgLy9DVFJMIE9OTFlcbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICBjbGFzc0VtcHR5OiBzdHJpbmc7XG4gIGNsYXNzSGFsZjogc3RyaW5nO1xuICBjbGFzc0ZpbGxlZDogc3RyaW5nO1xuXG4gIHBhdGhFbXB0eTogc3RyaW5nO1xuICBwYXRoSGFsZjogc3RyaW5nO1xuICBwYXRoRmlsbGVkOiBzdHJpbmc7XG5cbiAgY29sb3I6IHN0YXJSYXRpbmdDb2xvcjtcbiAgc3RhcnM6IEFycmF5PG51bWJlcj47XG4gIHJhdGluZ0FzSW50ZWdlcjogbnVtYmVyO1xuICBoYWxmU3RhclZpc2libGU6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIHNob3dIYWxmU3RhcnNcbiAgICovXG4gIHByb3RlY3RlZCBfc2hvd0hhbGZTdGFyczogYm9vbGVhbjtcbiAgZ2V0IHNob3dIYWxmU3RhcnMoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3Nob3dIYWxmU3RhcnM7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgc2hvd0hhbGZTdGFycyh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX3Nob3dIYWxmU3RhcnMgPSAhIXZhbHVlO1xuXG4gICAgLy91cGRhdGUgaGFsZlN0YXJWaXNpYmxlXG4gICAgdGhpcy5zZXRIYWxmU3RhclZpc2libGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXRDb2xvclxuICAgKi9cbiAgZ2V0Q29sb3I6IChcbiAgICByYXRpbmc6IG51bWJlcixcbiAgICBudW1PZlN0YXJzOiBudW1iZXIsXG4gICAgc3RhdGljQ29sb3I/OiBzdGFyUmF0aW5nQ29sb3JcbiAgKSA9PiBzdGFyUmF0aW5nQ29sb3I7XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGdldEhhbGZTdGFyVmlzaWJsZVxuICAgKi9cbiAgZ2V0SGFsZlN0YXJWaXNpYmxlOiAocmF0aW5nOiBudW1iZXIpID0+IGJvb2xlYW47XG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8vSW5wdXRzXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogaWQgcHJvcGVydHkgdG8gaWRlbnRpZnkgdGhlIERPTSBlbGVtZW50XG4gICAqL1xuICBwcm90ZWN0ZWQgX2lkOiBzdHJpbmc7XG4gIGdldCBpZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBpZCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5faWQgPSB2YWx1ZSB8fCAnJztcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBmb2N1c1xuICAgKi9cbiAgcHJvdGVjdGVkIF9mb2N1czogYm9vbGVhbjtcbiAgZ2V0IGZvY3VzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9mb2N1cztcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBmb2N1cyh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2ZvY3VzID0gISF2YWx1ZTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBsYWJlbFRleHRcbiAgICovXG4gIHByb3RlY3RlZCBfbGFiZWxUZXh0OiBzdHJpbmc7XG4gIGdldCBsYWJlbFRleHQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fbGFiZWxUZXh0O1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGxhYmVsVGV4dCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5fbGFiZWxUZXh0ID0gdmFsdWU7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogbGFiZWxQb3NpdGlvblxuICAgKi9cbiAgcHJvdGVjdGVkIF9sYWJlbFBvc2l0aW9uOiBzdGFyUmF0aW5nTGFiZWxQb3NpdGlvbjtcbiAgZ2V0IGxhYmVsUG9zaXRpb24oKTogc3RhclJhdGluZ0xhYmVsUG9zaXRpb24ge1xuICAgIHJldHVybiB0aGlzLl9sYWJlbFBvc2l0aW9uO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGxhYmVsUG9zaXRpb24odmFsdWU6IHN0YXJSYXRpbmdMYWJlbFBvc2l0aW9uKSB7XG4gICAgdGhpcy5fbGFiZWxQb3NpdGlvbiA9IHZhbHVlIHx8IHRoaXMuY29uZmlnLmxhYmVsUG9zaXRpb247XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogbGFiZWxWaXNpYmxlXG4gICAqL1xuICBwcm90ZWN0ZWQgX2xhYmVsVmlzaWJsZTogYm9vbGVhbjtcbiAgZ2V0IGxhYmVsVmlzaWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fbGFiZWxWaXNpYmxlO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGxhYmVsVmlzaWJsZSh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2xhYmVsVmlzaWJsZSA9ICEhdmFsdWU7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogaG92ZXJFbmFibGVkXG4gICAqL1xuICBwcm90ZWN0ZWQgX2hvdmVyRW5hYmxlZDogYm9vbGVhbjtcbiAgZ2V0IGhvdmVyRW5hYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5faG92ZXJFbmFibGVkO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGhvdmVyRW5hYmxlZCh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2hvdmVyRW5hYmxlZCA9IHZhbHVlICE9PSB1bmRlZmluZWQgPyAhIXZhbHVlIDogZmFsc2U7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogc3RhdGljQ29sb3JcbiAgICovXG4gIHByb3RlY3RlZCBfc3RhdGljQ29sb3I6IHN0YXJSYXRpbmdDb2xvcjtcbiAgZ2V0IHN0YXRpY0NvbG9yKCk6IHN0YXJSYXRpbmdDb2xvciB7XG4gICAgcmV0dXJuIHRoaXMuX3N0YXRpY0NvbG9yIHx8IHRoaXMuY29uZmlnLnN0YXRpY0NvbG9yIHx8IHVuZGVmaW5lZDtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBzdGF0aWNDb2xvcih2YWx1ZTogc3RhclJhdGluZ0NvbG9yKSB7XG4gICAgdGhpcy5fc3RhdGljQ29sb3IgPSB2YWx1ZTtcblxuICAgIC8vdXBkYXRlIGNvbG9yLlxuICAgIHRoaXMuc2V0Q29sb3IoKTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBkaXJlY3Rpb25cbiAgICovXG4gIHByb3RlY3RlZCBfZGlyZWN0aW9uOiBzdGFyUmF0aW5nRGlyZWN0aW9uO1xuICBnZXQgZGlyZWN0aW9uKCk6IHN0YXJSYXRpbmdEaXJlY3Rpb24ge1xuICAgIHJldHVybiB0aGlzLl9kaXJlY3Rpb247XG4gIH1cblxuICBASW5wdXQoKSBzZXQgZGlyZWN0aW9uKHZhbHVlOiBzdGFyUmF0aW5nRGlyZWN0aW9uKSB7XG4gICAgdGhpcy5fZGlyZWN0aW9uID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIG51bU9mU3RhcnNcbiAgICovXG4gIHByb3RlY3RlZCBfbnVtT2ZTdGFyczogbnVtYmVyO1xuICBnZXQgbnVtT2ZTdGFycygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9udW1PZlN0YXJzO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IG51bU9mU3RhcnModmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX251bU9mU3RhcnMgPSB2YWx1ZSA+IDAgPyB2YWx1ZSA6IHRoaXMuY29uZmlnLm51bU9mU3RhcnMhO1xuXG4gICAgLy91cGRhdGUgc3RhcnMgYXJyYXlcbiAgICB0aGlzLnN0YXJzID0gU3RhclJhdGluZ1V0aWxzLmdldFN0YXJzQXJyYXkodGhpcy5udW1PZlN0YXJzKTtcblxuICAgIC8vdXBkYXRlIGNvbG9yXG4gICAgdGhpcy5zZXRDb2xvcigpO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGhvdmVyUmF0aW5nXG4gICAqL1xuICBwcm90ZWN0ZWQgX2hvdmVyUmF0aW5nOiBudW1iZXI7XG4gIGdldCBob3ZlclJhdGluZygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9ob3ZlclJhdGluZztcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBob3ZlclJhdGluZyh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5faG92ZXJSYXRpbmcgPSB2YWx1ZSA+IDAgPyB2YWx1ZSA6IDA7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogc3BlZWRcbiAgICovXG4gIHByb3RlY3RlZCBfc3BlZWQ6IHN0YXJSYXRpbmdTcGVlZDtcbiAgZ2V0IHNwZWVkKCk6IHN0YXJSYXRpbmdTcGVlZCB7XG4gICAgcmV0dXJuIHRoaXMuX3NwZWVkO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHNwZWVkKHZhbHVlOiBzdGFyUmF0aW5nU3BlZWQpIHtcbiAgICB0aGlzLl9zcGVlZCA9IHZhbHVlIHx8IHRoaXMuY29uZmlnLnNwZWVkO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIHNpemVcbiAgICovXG4gIHByb3RlY3RlZCBfc2l6ZTogc3RhclJhdGluZ1NpemVzO1xuICBnZXQgc2l6ZSgpOiBzdGFyUmF0aW5nU2l6ZXMge1xuICAgIHJldHVybiB0aGlzLl9zaXplIHx8IHRoaXMuY29uZmlnLnNpemU7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgc2l6ZSh2YWx1ZTogc3RhclJhdGluZ1NpemVzKSB7XG4gICAgdGhpcy5fc2l6ZSA9IHZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIHN0YXJUeXBlXG4gICAqL1xuICBwcm90ZWN0ZWQgX3N0YXJUeXBlOiBzdGFyUmF0aW5nU3RhclR5cGVzO1xuICBnZXQgc3RhclR5cGUoKTogc3RhclJhdGluZ1N0YXJUeXBlcyB7XG4gICAgcmV0dXJuIHRoaXMuX3N0YXJUeXBlIHx8IHRoaXMuY29uZmlnLnN0YXJUeXBlO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHN0YXJUeXBlKHZhbHVlOiBzdGFyUmF0aW5nU3RhclR5cGVzKSB7XG4gICAgdGhpcy5fc3RhclR5cGUgPSB2YWx1ZTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBzcGFjZVxuICAgKi9cbiAgcHJvdGVjdGVkIF9zcGFjZTogc3RhclJhdGluZ1N0YXJTcGFjZTtcbiAgZ2V0IHNwYWNlKCk6IHN0YXJSYXRpbmdTdGFyU3BhY2Uge1xuICAgIHJldHVybiB0aGlzLl9zcGFjZTtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBzcGFjZSh2YWx1ZTogc3RhclJhdGluZ1N0YXJTcGFjZSkge1xuICAgIHRoaXMuX3NwYWNlID0gdmFsdWU7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogcmVhZE9ubHlcbiAgICovXG4gIHByb3RlY3RlZCBfcmVhZE9ubHk6IGJvb2xlYW47XG4gIGdldCByZWFkT25seSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fcmVhZE9ubHk7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgcmVhZE9ubHkodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9yZWFkT25seSA9ICEhdmFsdWU7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogZGlzYWJsZWRcbiAgICovXG4gIHByb3RlY3RlZCBfZGlzYWJsZWQ6IGJvb2xlYW47XG4gIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgZGlzYWJsZWQodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9kaXNhYmxlZCA9ICEhdmFsdWU7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICBwcml2YXRlIF9zdGVwOiBudW1iZXI7XG4gIGdldCBzdGVwKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX3N0ZXA7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgc3RlcCh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5fc3RlcCA9IHZhbHVlID4gMCA/IHZhbHVlIDogMTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiByYXRpbmdcbiAgICovXG4gIHByb3RlY3RlZCBfcmF0aW5nOiBudW1iZXI7XG4gIGdldCByYXRpbmcoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fcmF0aW5nO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHJhdGluZyh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5zZXRSYXRpbmcodmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIHNldFJhdGluZ1xuICAgKiBJIHVzZSBhIHNldHRlciBmdW5jdGlvbiBpbnN0ZWFkIG9mIGEgc2V0IG1ldGhvZCB0byBlbmFibGUgb3ZlcnJpZGVzIGZvciB0aGlzIGZ1bmN0aW9uLlxuICAgKiBAcGFyYW0gdmFsdWVcbiAgICovXG4gIHNldFJhdGluZyh2YWx1ZTogbnVtYmVyKSB7XG4gICAgLy92YWxpZGF0ZSBhbmQgYXBwbHkgbmV3UmF0aW5nXG4gICAgbGV0IG5ld1JhdGluZyA9IDA7XG4gICAgaWYgKHZhbHVlID49IDAgJiYgdmFsdWUgPD0gdGhpcy5udW1PZlN0YXJzKSB7XG4gICAgICBuZXdSYXRpbmcgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvL2xpbWl0IG1heCB2YWx1ZSB0byBtYXggbnVtYmVyIG9mIHN0YXJzXG4gICAgaWYgKHZhbHVlID4gdGhpcy5udW1PZlN0YXJzKSB7XG4gICAgICBuZXdSYXRpbmcgPSB0aGlzLm51bU9mU3RhcnM7XG4gICAgfVxuICAgIHRoaXMuX3JhdGluZyA9IG5ld1JhdGluZztcblxuICAgIC8vdXBkYXRlIHJhdGluZ0FzSW50ZWdlci4gcmF0aW5nIHBhcnNlZCB0byBpbnQgZm9yIHRoZSB2YWx1ZS1bbl0gbW9kaWZpZXJcbiAgICB0aGlzLnJhdGluZ0FzSW50ZWdlciA9IHBhcnNlSW50KHRoaXMuX3JhdGluZz8udG9TdHJpbmcoKSwgMTApO1xuXG4gICAgLy91cGRhdGUgaGFsZlN0YXJzVmlzaWJsZVxuICAgIHRoaXMuc2V0SGFsZlN0YXJWaXNpYmxlKCk7XG5cbiAgICAvL3VwZGF0ZSBjYWxjdWxhdGVkIENvbG9yXG4gICAgdGhpcy5zZXRDb2xvcigpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBTdGFyUmF0aW5nQ29uZmlnU2VydmljZSkge1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuXG4gICAgLy9zZXQgZGVmYXVsdCBjdHJsIHByb3BzXG4gICAgdGhpcy5jbGFzc0VtcHR5ID0gdGhpcy5jb25maWcuY2xhc3NFbXB0eSE7XG4gICAgdGhpcy5jbGFzc0hhbGYgPSB0aGlzLmNvbmZpZy5jbGFzc0hhbGYhO1xuICAgIHRoaXMuY2xhc3NGaWxsZWQgPSB0aGlzLmNvbmZpZy5jbGFzc0ZpbGxlZCE7XG4gICAgdGhpcy5wYXRoRW1wdHkgPSB0aGlzLmNvbmZpZy5zdmdQYXRoRW1wdHkhO1xuICAgIHRoaXMucGF0aEhhbGYgPSB0aGlzLmNvbmZpZy5zdmdQYXRoSGFsZiE7XG4gICAgdGhpcy5wYXRoRmlsbGVkID0gdGhpcy5jb25maWcuc3ZnUGF0aEZpbGxlZCE7XG5cbiAgICAvL3NldCBkZWZhdWx0IENvbXBvbmVudCBJbnB1dHNcbiAgICBpZiAoXG4gICAgICAnZ2V0Q29sb3InIGluIHRoaXMuY29uZmlnICYmXG4gICAgICB0eXBlb2YgdGhpcy5jb25maWcuZ2V0Q29sb3IgPT09ICdmdW5jdGlvbidcbiAgICApIHtcbiAgICAgIHRoaXMuZ2V0Q29sb3IgPSB0aGlzLmNvbmZpZy5nZXRDb2xvcjtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICAnZ2V0SGFsZlN0YXJWaXNpYmxlJyBpbiB0aGlzLmNvbmZpZyAmJlxuICAgICAgdHlwZW9mIHRoaXMuY29uZmlnLmdldEhhbGZTdGFyVmlzaWJsZSA9PT0gJ2Z1bmN0aW9uJ1xuICAgICkge1xuICAgICAgdGhpcy5nZXRIYWxmU3RhclZpc2libGUgPSB0aGlzLmNvbmZpZy5nZXRIYWxmU3RhclZpc2libGU7XG4gICAgfVxuXG4gICAgdGhpcy5udW1PZlN0YXJzID0gdGhpcy5jb25maWcubnVtT2ZTdGFycyE7XG4gICAgdGhpcy5yYXRpbmcgPSAwO1xuICAgIHRoaXMuc3RlcCA9IDE7XG4gIH1cblxuICBzdmdWaXNpYmxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnN0YXJUeXBlID09PSAnc3ZnJztcbiAgfVxuXG4gIGludGVyYWN0aW9uUG9zc2libGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICF0aGlzLnJlYWRPbmx5ICYmICF0aGlzLmRpc2FibGVkO1xuICB9XG5cbiAgc2V0Q29sb3IodXNlSG92ZXJWYWx1ZSA9IGZhbHNlKTogdm9pZCB7XG4gICAgLy9jaGVjayBpZiBjdXN0b20gZnVuY3Rpb24gaXMgZ2l2ZW5cbiAgICBjb25zdCByYXRpbmdWYWx1ZSA9IHVzZUhvdmVyVmFsdWUgPyB0aGlzLmhvdmVyUmF0aW5nIDogdGhpcy5yYXRpbmc7XG4gICAgaWYgKHR5cGVvZiB0aGlzLmdldENvbG9yID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aGlzLmNvbG9yID0gdGhpcy5nZXRDb2xvcihcbiAgICAgICAgcmF0aW5nVmFsdWUsXG4gICAgICAgIHRoaXMubnVtT2ZTdGFycyxcbiAgICAgICAgdGhpcy5zdGF0aWNDb2xvclxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb2xvciA9IFN0YXJSYXRpbmdVdGlscy5nZXRDb2xvcihcbiAgICAgICAgcmF0aW5nVmFsdWUsXG4gICAgICAgIHRoaXMubnVtT2ZTdGFycyxcbiAgICAgICAgdGhpcy5zdGF0aWNDb2xvclxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBzZXRIYWxmU3RhclZpc2libGUoKTogdm9pZCB7XG4gICAgLy91cGRhdGUgaGFsZlN0YXJWaXNpYmxlXG4gICAgaWYgKHRoaXMuc2hvd0hhbGZTdGFycykge1xuICAgICAgLy9jaGVjayBpZiBjdXN0b20gZnVuY3Rpb24gaXMgZ2l2ZW5cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5nZXRIYWxmU3RhclZpc2libGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5oYWxmU3RhclZpc2libGUgPSB0aGlzLmdldEhhbGZTdGFyVmlzaWJsZSh0aGlzLnJhdGluZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhhbGZTdGFyVmlzaWJsZSA9IFN0YXJSYXRpbmdVdGlscy5nZXRIYWxmU3RhclZpc2libGUodGhpcy5yYXRpbmcpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhhbGZTdGFyVmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGdldENvbXBvbmVudENsYXNzTmFtZXMoKTogc3RyaW5nIHtcbiAgICBjb25zdCBjbGFzc05hbWVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMucmF0aW5nID8gJ3ZhbHVlLScgKyB0aGlzLnJhdGluZ0FzSW50ZWdlciA6ICd2YWx1ZS0wJyk7XG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMuaGFsZlN0YXJWaXNpYmxlID8gJ2hhbGYnIDogJycpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLmhvdmVyRW5hYmxlZCA/ICdob3ZlcicgOiAnJyk7XG5cbiAgICBjb25zdCBob3ZlclJhdGluZyA9IHRoaXMuaG92ZXJSYXRpbmdcbiAgICAgID8gJ2hvdmVyLScgKyB0aGlzLmhvdmVyUmF0aW5nXG4gICAgICA6ICdob3Zlci0wJztcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5ob3ZlckVuYWJsZWQgPyBob3ZlclJhdGluZyA6ICcnKTtcblxuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLnNwYWNlID8gJ3NwYWNlLScgKyB0aGlzLnNwYWNlIDogJycpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLmxhYmVsUG9zaXRpb24gPyAnbGFiZWwtJyArIHRoaXMubGFiZWxQb3NpdGlvbiA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5jb2xvciA/ICdjb2xvci0nICsgdGhpcy5jb2xvciA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5zdGFyVHlwZSA/ICdzdGFyLScgKyB0aGlzLnN0YXJUeXBlIDogJycpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLnNwZWVkKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5zaXplKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5yZWFkT25seSA/ICdyZWFkLW9ubHknIDogJycpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLmRpc2FibGVkID8gJ2Rpc2FibGVkJyA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5kaXJlY3Rpb24gPyAnZGlyZWN0aW9uLScgKyB0aGlzLmRpcmVjdGlvbiA6ICcnKTtcblxuICAgIHJldHVybiBjbGFzc05hbWVzLmpvaW4oJyAnKTtcbiAgfVxuXG4gIGluY3JlbWVudCgpIHtcbiAgICAvL2luY3JlbWVudCB0byBuZXh0IGhpZ2hlciBzdGVwXG4gICAgY29uc3QgYWJzRGlmZiA9IE1hdGguYWJzKHRoaXMucmF0aW5nICUgdGhpcy5zdGVwKTtcbiAgICB0aGlzLnJhdGluZyA9IHRoaXMucmF0aW5nICsgKGFic0RpZmYgPiAwID8gdGhpcy5zdGVwIC0gYWJzRGlmZiA6IHRoaXMuc3RlcCk7XG4gIH1cblxuICBkZWNyZW1lbnQoKSB7XG4gICAgLy9kZWNyZW1lbnQgdG8gbmV4dCBsb3dlciBzdGVwXG4gICAgY29uc3QgYWJzRGlmZiA9IE1hdGguYWJzKHRoaXMucmF0aW5nICUgdGhpcy5zdGVwKTtcbiAgICB0aGlzLnJhdGluZyA9IHRoaXMucmF0aW5nIC0gKGFic0RpZmYgPiAwID8gYWJzRGlmZiA6IHRoaXMuc3RlcCk7XG4gIH1cblxuICByZXNldCgpIHtcbiAgICB0aGlzLnJhdGluZyA9IDA7XG4gIH1cbn1cbiJdfQ==